<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard</title>
<link rel="icon" href="favicon.ico">
<style>
body{
  margin:0;
  font-family:system-ui,sans-serif;
  color:#e6f0ff;
  background:radial-gradient(circle at top,#0b1e3d,#050b1a);
  overflow-x:hidden;
}

/* Welcome Wrapper */
#welcomeWrapper{
  display:flex;
  justify-content:center;
  flex-direction:column;
  align-items:center;
  margin-top:10vh;
  text-align:center;
  z-index:1;
}
.card{
  width:90%;
  max-width:400px;
  padding:30px;
  background:rgba(12,25,55,.65);
  backdrop-filter:blur(16px);
  border-radius:20px;
  box-shadow:0 20px 60px rgba(0,0,0,.4);
  margin-bottom:50px;
}
.subtext{
  margin-top:10px;
  font-size:0.9rem;
  opacity:0;
  transition: opacity 1.5s ease-in;
}

/* Scroll down text */
#scrollText{
  position:fixed;
  bottom:15px;
  left:50%;
  transform:translateX(-50%);
  font-size:1rem;
  animation: upDown 2s ease-in-out infinite;
  z-index:1;
}
@keyframes upDown{
  0%,100%{ transform:translateX(-50%) translateY(0); }
  50%{ transform:translateX(-50%) translateY(-10px); }
}

/* Scroll cards */
#cardsContainer{
  display:flex;
  flex-direction:column;
  align-items:center;
  padding-bottom:50px;
}
.scroll-card{
  opacity:0;
  transform:translateY(40px);
  width:90%;
  max-width:400px;
  margin:20px 0;
  padding:25px;
  background:rgba(12,25,55,.65);
  border-radius:20px;
  backdrop-filter:blur(16px);
  box-shadow:0 15px 45px rgba(0,0,0,.35);
  transition: all 0.8s ease-out;
}

/* Profile pic top-right */
#profilePic{
  position:fixed;
  top:20px;
  right:20px;
  width:50px;
  height:50px;
  border-radius:50%;
  display:flex;
  justify-content:center;
  align-items:center;
  font-weight:bold;
  font-size:1.3rem;
  color:white;
  cursor:pointer;
  user-select:none;
  z-index:100;
  background-size:contain;
  background-position:center;
  background-repeat:no-repeat;
}

/* Profile panel */
#profilePanel{
  position:fixed;
  top:80px;
  right:20px;
  width:180px;
  background:rgba(12,25,55,.85);
  backdrop-filter:blur(8px);
  border-radius:14px;
  display:none;
  flex-direction:column;
  padding:10px;
  z-index:100;
}
#profilePanel h4{
  margin:0 0 8px 0;
  font-size:1rem;
  text-align:center;
  border-bottom:1px solid rgba(255,255,255,0.2);
  padding-bottom:5px;
}
#profilePanel button{
  width:100%;
  margin:5px 0;
  padding:10px;
  border:none;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
}
.primary{ background:#4da3ff; color:black; }
.remove{ background:#ff4c4c; color:white; }

/* Menu button */
#menuBtn{
  position:fixed;
  top:20px;
  left:20px;
  width:40px;
  height:40px;
  display:flex;
  flex-direction:column;
  justify-content:space-around;
  cursor:pointer;
  z-index:101;
}
#menuBtn div{
  width:100%;
  height:4px;
  background:white;
  border-radius:2px;
}

/* Side panel */
#sidePanel{
  position:fixed;
  top:0;
  left:-250px;
  width:250px;
  height:100%;
  background:rgba(12,25,55,.95);
  backdrop-filter:blur(12px);
  display:flex;
  flex-direction:column;
  padding:20px;
  z-index:105;
  transition: left 0.4s ease;
}
#sidePanel.show{ left:0; }
#sidePanel .closePanel{
  align-self:flex-end;
  font-size:1.2rem;
  cursor:pointer;
}
#sidePanel h3{
  text-align:center;
  margin:10px 0;
  font-weight:bold;
  border-bottom:1px solid rgba(255,255,255,.2);
  padding-bottom:5px;
}
#sidePanel input{
  padding:8px;
  margin:10px 0;
  border-radius:8px;
  border:none;
  width:100%;
  background:#0c1937;
  color:white;
}
.sideTab{
  margin:10px 0;
  padding:10px;
  border-radius:10px;
  background:#0c1937;
  cursor:pointer;
  font-weight:bold;
}
.sideTab.selected{ background:#4da3ff; color:black; }

/* Blur overlay behind panel */
#panelBlur{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.4);
  backdrop-filter:blur(4px);
  display:none;
  z-index:104;
}
</style>
</head>
<body>

<!-- Menu -->
<div id="menuBtn"><div></div><div></div><div></div></div>

<!-- Side Panel -->
<div id="sidePanel">
  <span class="closePanel">âœ•</span>
  <h3>Navigation</h3>
  <input type="text" placeholder="Search...">
  <div class="sideTab selected" data-target="dashboard">Dashboard</div>
  <div class="sideTab" data-target="settings">Settings</div>
  <div class="sideTab" data-target="chat">Communicate</div>
</div>
<div id="panelBlur"></div>

<!-- Profile -->
<div id="profilePic"></div>
<div id="profilePanel">
  <h4 id="profileName">Username</h4>
  <button class="primary" onclick="openSettings()">Settings</button>
  <button class="primary" onclick="confirmLogout()">Logout</button>
</div>

<!-- Welcome -->
<div id="welcomeWrapper">
  <div class="card">
    <h2 id="welcomeText">Welcome</h2>
    <div class="subtext" id="welcomeSubtext">Use the menu to navigate</div>
  </div>
</div>

<!-- Scroll down prompt -->
<div id="scrollText">Scroll down for more info</div>

<!-- Scroll cards container -->
<div id="cardsContainer">
  <div class="scroll-card">ðŸš€ Cool feature 1: Fast, responsive design</div>
  <div class="scroll-card">ðŸ’¡ Tip: Use the menu to quickly access sections</div>
  <div class="scroll-card">ðŸŽ¨ Design: Radial gradient background + smooth animations</div>
  <div class="scroll-card">âš¡ Optimized for mobile & desktop</div>
  <div class="scroll-card">ðŸ”’ Secure login & user management</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
import { getFirestore, doc, getDoc, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

/* Firebase */
const app = initializeApp({
  apiKey:"AIzaSyDmRrflu-Ysm6DyxV65SrMZ0AL7TP58mX4",
  authDomain:"login-34954.firebaseapp.com",
  projectId:"login-34954"
});
const auth = getAuth(app);
const db = getFirestore(app);

/* Elements */
const welcomeSubtext=document.getElementById("welcomeSubtext");
const profilePic=document.getElementById("profilePic");
const profilePanel=document.getElementById("profilePanel");
const profileName=document.getElementById("profileName");
const scrollCards=document.querySelectorAll(".scroll-card");
const menuBtn=document.getElementById("menuBtn");
const sidePanel=document.getElementById("sidePanel");
const panelBlur=document.getElementById("panelBlur");
const sideTabs=document.querySelectorAll(".sideTab");

/* Show subtext after load */
window.addEventListener("load",()=>{ setTimeout(()=>welcomeSubtext.style.opacity=1,500); });

/* Auth & PFP */
onAuthStateChanged(auth, async user=>{
  if(!user) location.href="login.html";
  let username=user.displayName || user.email.split("@")[0];
  profileName.textContent=username;
  profilePic.textContent=username[0].toUpperCase();
  profilePic.style.backgroundColor=stringToColor(username);
  profilePic.style.backgroundSize="contain";
  profilePic.style.backgroundPosition="center";

  const pfpDoc=await getDoc(doc(db,"userPFPs",user.uid));
  if(pfpDoc.exists() && pfpDoc.data().data){
    profilePic.style.backgroundImage=`url(${pfpDoc.data().data})`;
    profilePic.textContent="";
  }
});

/* Helper */
function stringToColor(str){
  let hash=0; for(let c of str) hash=c.charCodeAt(0)+((hash<<5)-hash);
  return `hsl(${hash%360},70%,50%)`;
}

/* Profile panel toggle */
let panelOpen=false;
profilePic.onclick=()=>{ panelOpen=!panelOpen; profilePanel.style.display=panelOpen?"flex":"none"; };

/* Logout */
function confirmLogout(){ if(confirm("Logout?")) signOut(auth).then(()=>location.href="login.html"); }
function openSettings(){ location.href="settings.html"; }

/* Side menu */
menuBtn.onclick=()=>{ sidePanel.classList.add("show"); panelBlur.style.display="block"; menuBtn.style.display="none"; };
sidePanel.querySelector(".closePanel").onclick=()=>{ sidePanel.classList.remove("show"); panelBlur.style.display="none"; menuBtn.style.display="flex"; };

/* Tabs logic */
sideTabs.forEach(tab=>{
  tab.onclick=()=>{
    const target=tab.dataset.target;
    sidePanel.classList.remove("show");
    panelBlur.style.display="none";
    menuBtn.style.display="flex";
    setTimeout(()=>{
      if(target==="dashboard") location.href="dashboard.html";
      else if(target==="settings") location.href="settings.html";
      else if(target==="chat") location.href="chat.html";
    },400);
  };
});

/* Scroll animations */
function animateOnScroll(){
  scrollCards.forEach(card=>{
    const rect=card.getBoundingClientRect();
    if(rect.top < window.innerHeight - 100){
      card.style.opacity=1;
      card.style.transform="translateY(0)";
    }
  });
}
window.addEventListener("scroll",animateOnScroll);
animateOnScroll(); // in case some are already visible

</script>
</body>
</html>